# Работа с почтой в Односкрипте

Отправка посредством SMTP.

## Установка через OPM

```
opm install InternetMail
```

## Пример отправки HTML сообщения со вложениями из OneScript через Yandex

```
#Использовать InternetMail

Профиль = Новый ИнтернетПочтовыйПрофиль;
Профиль.Таймаут = 30;
Профиль.АдресСервераSMTP = "smtp.yandex.ru";
Профиль.ПользовательSMTP = "from@yandex.ru";
Профиль.ПарольSMTP = "Пароль";
Профиль.ПортSMTP = 587;
Профиль.ИспользоватьSSLSMTP = Истина;

Профиль.АдресСервераPOP3 = "pop.yandex.ru";
Профиль.ИспользоватьSSLPOP3 = Истина;
Профиль.Пользователь = "from@yandex.ru";
Профиль.Пароль = "Пароль";


Сообщение = Новый ИнтернетПочтовоеСообщение;
Сообщение.Получатели.Добавить("to@gmail.com");
Сообщение.ИмяОтправителя = "My name";
Сообщение.Отправитель = "from@yandex.ru";
Сообщение.Тема = "Тема тестового сообщения";

Текст =  "
	|<h3>Пример !</h3>
	|Это пример HTML сообщения.<br/>";

Сообщение.Тексты.Добавить(Текст, ТипТекстаПочтовогоСообщения.HTML);
Сообщение.Вложения.Добавить("C:/Пример вложения 1.docx");
Сообщение.Вложения.Добавить(
        Новый ДвоичныеДанные("C:/Пример вложения 2.docx"),
        "Пример вложения 2.docx"
);

Почта = Новый ИнтернетПочта;
Почта.Подключиться(Профиль, ПротоколИнтернетПочты.POP3);
Почта.Послать(Сообщение, , ПротоколИнтернетПочты.SMTP);
```